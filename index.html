<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Kazƒ± Oyunu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
 margin:0;
 background:#6b4f2a;
 color:white;
 font-family:Arial;
 overflow:hidden;
}
canvas{
 background:#8b6a3e;
 display:none;
 margin:auto;
}
#menu{
 position:fixed; inset:0;
 display:flex; flex-direction:column;
 justify-content:center; align-items:center;
}
button{
 font-size:18px;
 padding:12px 26px;
 margin:10px;
 border:none;
 border-radius:10px;
}
#mobileControls{
 position:fixed;
 bottom:20px;
 left:50%;
 transform:translateX(-50%);
 display:none;
 gap:10px;
}
.ctrl{
 width:60px; height:60px;
 border-radius:50%;
 background:#444;
 color:white;
 font-size:22px;
}
#kazBtn{
 position:fixed;
 bottom:120px;
 left:50%;
 transform:translateX(-50%);
 padding:14px 36px;
 font-size:20px;
 display:none;
}
#museumBtn{
 position:fixed;
 top:20px;
 right:20px;
 padding:10px 16px;
}
</style>
</head>
<body>

<!-- MEN√ú -->
<div id="menu">
 <h1>Kazƒ± Oyunu</h1>
 <p>Platform se√ß</p>
 <button onclick="start('pc')">üíª PC</button>
 <button onclick="start('mobile')">üì± Mobil</button>
</div>

<canvas id="game" width="400" height="600"></canvas>

<!-- MOBƒ∞L KONTROLLER -->
<div id="mobileControls">
 <button class="ctrl" ontouchstart="keys.up=true" ontouchend="keys.up=false">‚¨ÜÔ∏è</button>
 <div style="display:flex;gap:10px">
  <button class="ctrl" ontouchstart="keys.left=true" ontouchend="keys.left=false">‚¨ÖÔ∏è</button>
  <button class="ctrl" ontouchstart="keys.right=true" ontouchend="keys.right=false">‚û°Ô∏è</button>
 </div>
 <button class="ctrl" ontouchstart="keys.down=true" ontouchend="keys.down=false">‚¨áÔ∏è</button>
</div>

<button id="kazBtn">‚õèÔ∏è KAZ</button>
<button id="museumBtn">üèõÔ∏è M√ºze</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const kazBtn = document.getElementById("kazBtn");
const museumBtn = document.getElementById("museumBtn");

const tile = 40;
const cols = 10;
const rows = 300;

let cameraY = 0;
let gameState = "play";
let activeArtifact = null;
let showMuseum = false;

// Oyuncu
const player = { x:200, y:100, spd:4 };

// Kontroller
const keys = {up:false,down:false,left:false,right:false};
onkeydown=e=>{
 if(e.key==="ArrowUp")keys.up=true;
 if(e.key==="ArrowDown")keys.down=true;
 if(e.key==="ArrowLeft")keys.left=true;
 if(e.key==="ArrowRight")keys.right=true;
};
onkeyup=e=>{
 if(e.key==="ArrowUp")keys.up=false;
 if(e.key==="ArrowDown")keys.down=false;
 if(e.key==="ArrowLeft")keys.left=false;
 if(e.key==="ArrowRight")keys.right=false;
};

// Toprak
const soil=[];
for(let y=0;y<rows;y++){
 soil[y]=[];
 for(let x=0;x<cols;x++) soil[y][x]=true;
}

// Eserler
const artifacts=[
 {x:160,y:500,damage:0},
 {x:240,y:900,damage:0},
 {x:80,y:1400,damage:0}
];

// M√ºze
const museum=[];

// Nadirlik
function getRarity(y){
 if(y<600) return {name:"Sƒ±radan",color:"blue"};
 if(y<1200) return {name:"Epic",color:"purple"};
 return {name:"Efsanevi",color:"gold"};
}

// Katman rengi
function soilColor(y){
 if(y<400) return "#c2a36b";
 if(y<900) return "#8b6a3e";
 if(y<1500) return "#5a3d1e";
 return "#3a2a18";
}

// Kaz
function dig(){
 const gx=Math.floor(player.x/tile);
 const gy=Math.floor(player.y/tile);
 if(soil[gy] && soil[gy][gx]) soil[gy][gx]=false;
}

// Tutturma barƒ±
let barPos=0, barDir=1;

kazBtn.onclick=()=>{
 let success=true;
 if(barPos<120||barPos>280){
  activeArtifact.damage=2;
  success=false;
 }
 if(success){
  const r=getRarity(activeArtifact.y);
  museum.push(r);
 }
 kazBtn.style.display="none";
 gameState="play";
};

museumBtn.onclick=()=>{
 showMuseum=!showMuseum;
 gameState=showMuseum?"museum":"play";
};

// Ba≈ülat
function start(p){
 document.getElementById("menu").style.display="none";
 canvas.style.display="block";
 if(p==="mobile")
  document.getElementById("mobileControls").style.display="flex";
 loop();
}

function update(){
 if(gameState==="play"){
  if(keys.up)player.y-=player.spd;
  if(keys.down)player.y+=player.spd;
  if(keys.left)player.x-=player.spd;
  if(keys.right)player.x+=player.spd;

  dig();
  cameraY = player.y - canvas.height/2 + tile/2;

  artifacts.forEach(a=>{
   if(
    player.x<a.x+tile &&
    player.x+tile>a.x &&
    player.y<a.y+tile &&
    player.y+tile>a.y &&
    a.damage===0
   ){
    gameState="kaz";
    activeArtifact=a;
    kazBtn.style.display="block";
   }
  });
 }

 if(gameState==="kaz"){
  barPos+=4*barDir;
  if(barPos>300||barPos<0)barDir*=-1;
 }
}

function drawSoil(){
 for(let y=0;y<rows;y++){
  for(let x=0;x<cols;x++){
   if(soil[y][x]){
    ctx.fillStyle=soilColor(y*tile);
    ctx.fillRect(x*tile,y*tile-cameraY,tile,tile);
   }
  }
 }
}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 drawSoil();

 // eserler
 artifacts.forEach(a=>{
  const r=getRarity(a.y);
  ctx.fillStyle=r.color;
  ctx.fillRect(a.x,a.y-cameraY,tile,tile);
 });

 // oyuncu
 ctx.fillStyle="blue";
 ctx.fillRect(player.x,player.y-cameraY,tile,tile);

 // kaz barƒ±
 if(gameState==="kaz"){
  ctx.fillStyle="red";ctx.fillRect(50,250,300,20);
  ctx.fillStyle="yellow";ctx.fillRect(100,250,200,20);
  ctx.fillStyle="green";ctx.fillRect(170,250,60,20);
  ctx.fillStyle="white";ctx.fillRect(50+barPos,245,5,30);
 }

 // m√ºze
 if(showMuseum){
  ctx.fillStyle="rgba(0,0,0,0.85)";
  ctx.fillRect(0,0,400,600);
  ctx.fillStyle="white";
  ctx.font="24px Arial";
  ctx.fillText("üèõÔ∏è M√úZE",130,50);
  ctx.font="18px Arial";
  if(museum.length===0){
   ctx.fillText("Hen√ºz eser yok",110,100);
  }else{
   museum.forEach((e,i)=>{
    ctx.fillStyle=e.color;
    ctx.fillText((i+1)+". "+e.name+" eser",80,100+i*30);
   });
  }
 }
}

function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}
</script>

</body>
</html>