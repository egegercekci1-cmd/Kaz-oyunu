<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Kazƒ± Oyunu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
html,body{margin:0;padding:0;overflow:hidden;background:#4a2f16;color:#fff;font-family:Arial}
canvas{display:block;background:#6b4a2b}
#topUI{position:fixed;top:10px;left:10px;z-index:5}
#topUI button{padding:8px 12px;margin-right:6px;font-size:14px}
#mobileControls{position:fixed;bottom:20px;left:0;right:0;display:none;z-index:5;text-align:center}
#mobileControls button{padding:14px 16px;margin:6px;font-size:18px}
#digBtn{position:fixed;bottom:120px;left:50%;transform:translateX(-50%);display:none;z-index:6}
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="topUI">
  <button onclick="openMuseum()">üèõÔ∏è M√ºze</button>
  <button onclick="openShop()">üõí Maƒüaza</button>
</div>

<button id="digBtn" onclick="digAttempt()">‚õèÔ∏è Kaz</button>

<div id="mobileControls">
  <button ontouchstart="move.left=true" ontouchend="move.left=false">‚¨ÖÔ∏è</button>
  <button ontouchstart="move.right=true" ontouchend="move.right=false">‚û°Ô∏è</button>
  <button ontouchstart="move.up=true" ontouchend="move.up=false">‚¨ÜÔ∏è</button>
  <button ontouchstart="move.down=true" ontouchend="move.down=false">‚¨áÔ∏è</button>
</div>

<script>
/* =================== AYAR & CANVAS =================== */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
function resize(){
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
}
window.addEventListener("resize",resize);
resize();

/* =================== OYUN DURUMLARI =================== */
let gameState="select"; // select, play, dig, museum, shop
let controlType="pc";

/* =================== HAREKET =================== */
const move={left:false,right:false,up:false,down:false};

/* =================== OYUNCU =================== */
const player={x:200,y:100,size:32,speed:4};

/* =================== KAMERA =================== */
let cameraY=0;

/* =================== EKONOMƒ∞ =================== */
let money=0;
let rarityBonus=0;
let sellBonus=0;
let digPrecision=0;

/* =================== M√úZE =================== */
const museum=[];

/* =================== MAƒûAZA =================== */
const shopItems=[
 {name:"+%5 Nadirlik",cost:50,buy:()=>rarityBonus+=5},
 {name:"Kazƒ± Hassasiyeti",cost:40,buy:()=>digPrecision+=15},
 {name:"Satƒ±≈ü +10 $A",cost:60,buy:()=>sellBonus+=10}
];

/* =================== ESERLER =================== */
const artifacts=[
 {x:120,y:500,rarity:null,done:false},
 {x:260,y:900,rarity:null,done:false},
 {x:180,y:1400,rarity:null,done:false}
];

function rollRarity(y){
 let r=Math.random()*100 + rarityBonus;
 if(y<600) return r<80?{n:"Sƒ±radan",c:"blue",v:10}:{n:"Epic",c:"purple",v:30};
 if(y<1200){
  if(r<60) return {n:"Epic",c:"purple",v:30};
  if(r<90) return {n:"Sƒ±radan",c:"blue",v:10};
  return {n:"Efsanevi",c:"gold",v:100};
 }
 return r<70?{n:"Epic",c:"purple",v:30}:{n:"Efsanevi",c:"gold",v:100};
}
artifacts.forEach(a=>a.rarity=rollRarity(a.y));

/* =================== KAZI MINI GAME =================== */
let activeArtifact=null;
let barPos=200,barDir=1;
let digTries=0;

function startDig(a){
 activeArtifact=a;
 gameState="dig";
 digTries=0;
 document.getElementById("digBtn").style.display="block";
}

function getZone(pos){
 const gStart=180-digPrecision/2, gEnd=220+digPrecision/2;
 const yStart=140, yEnd=260;
 if(pos>gStart && pos<gEnd) return "green";
 if(pos>yStart && pos<yEnd) return "yellow";
 return "red";
}

function digAttempt(){
 const zone=getZone(barPos);
 if(zone==="green"){
  collectArtifact();
  closeDig();
 }else if(zone==="yellow"){
  digTries++;
  if(digTries>=2){
   breakArtifact();
   closeDig();
  }
 }else{
  breakArtifact();
  closeDig();
 }
}

function collectArtifact(){
 museum.push(activeArtifact.rarity);
 money += activeArtifact.rarity.v + sellBonus;
 activeArtifact.done=true;
}

function breakArtifact(){
 activeArtifact.done=true;
}

function closeDig(){
 gameState="play";
 activeArtifact=null;
 document.getElementById("digBtn").style.display="none";
}

/* =================== KONTROLLER =================== */
// PC
document.addEventListener("keydown",e=>{
 if(controlType!=="pc")return;
 if(e.key==="ArrowLeft")move.left=true;
 if(e.key==="ArrowRight")move.right=true;
 if(e.key==="ArrowUp")move.up=true;
 if(e.key==="ArrowDown")move.down=true;
 if(e.key===" " && gameState==="dig")digAttempt();
});
document.addEventListener("keyup",e=>{
 if(controlType!=="pc")return;
 if(e.key==="ArrowLeft")move.left=false;
 if(e.key==="ArrowRight")move.right=false;
 if(e.key==="ArrowUp")move.up=false;
 if(e.key==="ArrowDown")move.down=false;
});

/* =================== UI =================== */
function openMuseum(){gameState="museum"}
function openShop(){gameState="shop"}

/* =================== UPDATE =================== */
function update(){
 if(gameState!=="play")return;
 if(move.left)player.x-=player.speed;
 if(move.right)player.x+=player.speed;
 if(move.up)player.y-=player.speed;
 if(move.down)player.y+=player.speed;
 cameraY=player.y-canvas.height/2;
}

/* =================== DRAW =================== */
function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 if(gameState==="select"){
  ctx.fillStyle="#fff";
  ctx.font="24px Arial";
  ctx.fillText("Platform Se√ß",canvas.width/2-80,canvas.height/2-40);
  ctx.fillText("PC i√ßin tƒ±kla",canvas.width/2-90,canvas.height/2+10);
  ctx.fillText("Mobil i√ßin √ßift tƒ±k",canvas.width/2-120,canvas.height/2+60);
  return;
 }

 // oyuncu
 ctx.fillStyle="blue";
 ctx.fillRect(player.x,player.y-cameraY,player.size,player.size);

 // eserler
 artifacts.forEach(a=>{
  if(a.done) return;
  ctx.fillStyle=a.rarity.c;
  ctx.fillRect(a.x,a.y-cameraY,30,30);
  if(gameState==="play" && Math.abs(player.x-a.x)<30 && Math.abs(player.y-a.y)<30){
    startDig(a);
  }
 });

 // para
 ctx.fillStyle="#fff";
 ctx.font="16px Arial";
 ctx.fillText("üí∞ "+money+" $A",20,30);

 // kazƒ± mini-game
 if(gameState==="dig"){
  barPos+=barDir*4;
  if(barPos>300||barPos<100)barDir*=-1;

  ctx.fillStyle="#222";
  ctx.fillRect(canvas.width/2-150,canvas.height/2-10,300,20);

  ctx.fillStyle="red";
  ctx.fillRect(canvas.width/2-150,canvas.height/2-10,60,20);
  ctx.fillRect(canvas.width/2+90,canvas.height/2-10,60,20);

  ctx.fillStyle="yellow";
  ctx.fillRect(canvas.width/2-90,canvas.height/2-10,180,20);

  ctx.fillStyle="green";
  ctx.fillRect(canvas.width/2-40-digPrecision/2,canvas.height/2-10,80+digPrecision,20);

  ctx.fillStyle="#fff";
  ctx.fillRect(canvas.width/2-150+barPos-100,canvas.height/2-15,4,30);
 }

 // m√ºze
 if(gameState==="museum"){
  ctx.fillStyle="#000";ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#fff";ctx.fillText("üèõÔ∏è M√ºze",canvas.width/2-40,40);
  museum.forEach((e,i)=>{
   ctx.fillStyle=e.c;
   ctx.fillText(e.n+" ("+e.v+"$)",80,80+i*30);
  });
 }

 // maƒüaza
 if(gameState==="shop"){
  ctx.fillStyle="#000";ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#fff";ctx.fillText("üõí Maƒüaza",canvas.width/2-50,40);
  shopItems.forEach((s,i)=>{
   ctx.fillText(s.name+" - "+s.cost+"$A",60,100+i*40);
  });
 }
}

/* =================== Gƒ∞Rƒ∞≈û =================== */
canvas.addEventListener("click",()=>{
 if(gameState==="select"){
  controlType="pc"; gameState="play";
 }
 else if(gameState==="shop"){
  shopItems.forEach(s=>{
   if(money>=s.cost){money-=s.cost; s.buy();}
  });
 }
});
canvas.addEventListener("dblclick",()=>{
 if(gameState==="select"){
  controlType="mobile";
  document.getElementById("mobileControls").style.display="block";
  gameState="play";
 }
});

function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>